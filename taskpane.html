<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>AI Excel 对话插件</title><link rel="stylesheet" href="taskpane.css"><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><script defer="defer" src="taskpane.79734b4d06dd79428ef4.js"></script></head><body><div class="container"><header class="header"><div class="logo"><svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg><h1>AI Excel 助手</h1></div><button id="settingsBtn" class="settings-btn" title="设置"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg></button></header><div class="ai-mode-indicator" id="aiModeIndicator"><span class="mode-dot local"></span> <span class="mode-text">本地模式</span></div><div class="selection-status" id="selectionStatus"><span class="status-icon">📊</span> <span class="status-text">请先在 Excel 中框选数据区域</span></div><div class="chat-container" id="chatContainer"><div class="message assistant"><div class="message-content"><p>👋 你好！我是 AI Excel 助手。</p><p>在 Excel 中框选包含表头的数据区域，然后告诉我你想查询什么或生成什么图表。</p><p class="examples-title">例如：</p><ul class="examples"><li>「广州的总销售额是多少？」</li><li>「各区域销售额做柱状图」</li><li>「平均价格是多少？」</li></ul></div></div></div><div class="input-container"><div class="input-wrapper"><textarea id="userInput" class="input-field" placeholder="输入你的问题，如：总销售额是多少？" rows="1"></textarea> <button id="submitBtn" class="submit-btn" title="发送"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg></button></div><div class="action-buttons"><button id="fillBtn" class="action-btn fill-btn" title="将结果填充到单元格" disabled="disabled"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 5v14M5 12h14"></path></svg> 填充</button> <button id="clearBtn" class="action-btn clear-btn" title="清空对话"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg> 清空</button></div></div><div class="loading-overlay" id="loadingOverlay" style="display: none;"><div class="loading-spinner"></div><p>正在处理...</p></div><div class="settings-modal" id="settingsModal" style="display: none;"><div class="settings-content"><div class="settings-header"><h2>AI 模型设置</h2><button id="closeSettingsBtn" class="close-btn">&times;</button></div><div class="settings-body"><div class="form-group"><label for="providerSelect">AI 服务提供商</label> <select id="providerSelect" class="form-control"><option value="local">本地模式（关键词匹配）</option><option value="openai">OpenAI</option><option value="azure">Azure OpenAI</option><option value="qwen">通义千问 (Qwen)</option></select></div><div id="apiConfigSection" style="display: none;"><div class="form-group"><label for="apiKeyInput">API Key</label> <input type="password" id="apiKeyInput" class="form-control" placeholder="输入你的 API Key"></div><div class="form-group" id="endpointGroup" style="display: none;"><label for="apiEndpointInput">API 端点 (可选)</label> <input id="apiEndpointInput" class="form-control" placeholder="自定义 API 端点"> <small class="form-hint" id="endpointHint"></small></div><div class="form-group"><label for="modelInput">模型名称 (可选)</label> <input id="modelInput" class="form-control" placeholder="如 gpt-3.5-turbo"> <small class="form-hint" id="modelHint"></small></div></div><div class="provider-info" id="providerInfo"><p>本地模式使用关键词匹配，无需 API 配置，所有数据本地处理。</p></div></div><div class="settings-footer"><button id="testConnectionBtn" class="btn btn-secondary" style="display: none;">测试连接</button> <button id="saveSettingsBtn" class="btn btn-primary">保存设置</button></div></div></div><div id="version-ind" style="text-align: center; color: #ccc; font-size: 10px; padding: 10px;">VER: v1.1.1 (Robust Mode & Cache Busting)</div></div></body></html>